
orchid {
    runTask = 'build'
    theme   = 'BsDoc'

    // set version number
    def v = project.version.toString()
    if(v.endsWith("-SNAPSHOT")) {
        v = v.replaceAll("-SNAPSHOT", "")
        def vs = v.split("\\.")
        def major = (vs[0] as int)
        def minor = (vs[1] as int)
        def patch = (vs[2] as int) - 1
        version = "$major.$minor.$patch"
    }
    else {
        def vs = v.split("\\.")
        def major = (vs[0] as int)
        def minor = (vs[1] as int)
        def patch = (vs[2] as int)
        version = "$major.$minor.$patch"
    }

    // set base URL
    if (project.hasProperty('env') && project.property('env') == 'prod') {
        environment = 'prod'
        if(Boolean.parseBoolean(System.getenv('PULL_REQUEST'))) {
            baseUrl = System.getenv('DEPLOY_URL') // Netlify deploy preview URL
        }
        else {
            baseUrl = System.getenv('URL') // Netlify production URL
        }
    }
    else {
        baseUrl = 'http://localhost:8080' // local development URL
    }

    // additional command-line args
    args = [
        "absApiKey ${project.properties['ABS_ApiKey']}"
    ]
}
